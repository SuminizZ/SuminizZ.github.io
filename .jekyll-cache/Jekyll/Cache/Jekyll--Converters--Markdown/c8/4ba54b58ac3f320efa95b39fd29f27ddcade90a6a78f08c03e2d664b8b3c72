I"õ<h2 id="cluster-configuration-with-cloudera-manager"><strong>Cluster Configuration with Cloudera Manager</strong></h2>
<ul>
  <li>
    <p>The image below shows the configuration of cluster that we will set up today</p>

    <p><img src="https://user-images.githubusercontent.com/92680829/177786207-9bc9f332-a134-4286-b010-7dbfed4c51d2.png" width="730" /></p>
    <ul>
      <li>Hadoop01 : namenode with cloudera mangaer installed, this node will serve as our <strong>Cloudera Manager Server</strong></li>
      <li>Hadoop02 - 04 : datanodes linked with Hadoop01 namenode will be our <strong>Cloudera Manager Agents</strong></li>
    </ul>
  </li>
</ul>

<h3 id="--serveragent-architecture-of-cloudera"><strong>- Server/Agent Architecture of Cloudera</strong></h3>

<p><img width="500" alt="image" src="https://user-images.githubusercontent.com/92680829/177797869-1d18a839-8537-4939-b822-2ff80bb4aa6d.png" /></p>

<ul>
  <li><strong>Cloudera Manager Server</strong>
    <ul>
      <li>Cloudera Manager runs a central server â€œthe Cloudera Manager Serverâ€, which has also been called the â€œSCM Serverâ€</li>
      <li>It hosts the Cloudera Manager Admin Console (Web-based user interface that administrators use to manage clusters and Cloudera Manager) and API</li>
      <li>Itâ€™s also responsible for installing software, configuring, starting, and stopping services</li>
      <li>Monitors the heartbeats coming from every cloudera agents and send orders for those agents to perform</li>
    </ul>
  </li>
  <li><strong>Agent</strong>
    <ul>
      <li>Installed on every host.</li>
      <li>mainly responsible for actually starting and stopping processes ordered from server, unpacking configurations, triggering installations, and monitoring the host.</li>
      <li>Reports current state of its host to the server and detects a new process from the server heartbeats</li>
      <li>Upon detection, it creates a directory for it in <code class="language-plaintext highlighter-rouge">/var/run/cloudera-scm-agent</code> and unpacks the configuration. It then contacts to â€œsupervisordâ€, which actually starts the process detected</li>
    </ul>
  </li>
  <li><strong>Heartbeating</strong>
    <ul>
      <li>Server and Agent communicates through a process called â€œHeartbeatingâ€, which is a primary communication mechanism in Cloudera Manager</li>
      <li>By default, Agents send heartbeats every 15 seconds to the Cloudera Manager Server (frequency can be optimized if necessary).</li>
      <li>During the heartbeat exchange, the Agent notifies the Cloudera Manager Server of its state and activities. In response, Cloudera Manager Server allocates the actions the Agent should perform.</li>
      <li>If agent stops heartbeating, the host is marked as having bad condition</li>
    </ul>
  </li>
</ul>

<h3 id="1-install-cloudera-manager-and-create-centoscm-imagea">1. Install Cloudera Manager and Create CentOS:CM Imagea</h3>

<ul>
  <li>(local terminal) create a container named hadoop01 with centos:base image with the right options
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span>docker run <span class="nt">--privileged</span> <span class="nt">--name</span> hadoop01 <span class="nt">-p</span> 7180:7180 <span class="nt">-itd</span> <span class="nt">-h</span> hadoop01.hadoop.com <span class="nt">-e</span> <span class="nv">container</span><span class="o">=</span>docker <span class="nt">-v</span> /sys/fs/cgroup:/sys/fs/cgroup:ro centos:base /usr/sbin/init

  <span class="nv">$ </span>docker <span class="nb">exec</span> <span class="nt">-it</span> hadoop01 /bin/bash
</code></pre></div>    </div>
    <ul>
      <li><strong>Docker run options</strong> (<a href="https://docs.docker.com/engine/reference/commandline/run/#options"><span style="color:blue">Documentations</span></a>)
        <ul>
          <li>-p : port forwarding localhost 7180 to docker container 7180</li>
          <li>-h : Container host name</li>
          <li>-e (â€“env) : set simple (non-array) environment variables in the container youâ€™re running, or overwrite variables that are defined in the Dockerfile of the image youâ€™re running</li>
          <li>-v (â€“volume) : mounts the current working directory into the container
            <ul>
              <li>volumes :  file systems mounted on Docker containers to preserve data generated by the running that container</li>
              <li>can be optionally suffixed with <code class="language-plaintext highlighter-rouge">:ro</code> or <code class="language-plaintext highlighter-rouge">:rw</code> to mount the volumes in read-only or read-write mode, respectively</li>
            </ul>
          </li>
          <li>â€“privileged : Give extended privileges to this container (without this, mounting will be denied)</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>(container : hadoop01) if you are successfully connected the running container, then letâ€™s execute the cloudera manager installer
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span><span class="nb">cd</span>
  <span class="nv">$ </span>./cloudera-manager-installer.bin
</code></pre></div>    </div>
    <ul>
      <li>keep enter â€œyesâ€</li>
    </ul>
  </li>
</ul>

:ET