---
layout: post
title : "[Paper Review] Path Aggregation Network for Instance Segmentation (PANet, 2018)"
img: papers/objd/panet.png
categories: [papers-objd]  
tag : [Paper Review, Object Detection, YOLO, YOLO V3, PyTorch]
toc : true
toc_sticky : true
---

## **Outlines**
- [**Reference**](#reference)
- [**Implementation with PyTorch**](#implementation-with-pytorch)
- [**YOLO : Single-State Object Detection**](#yolo--single-state-object-detection)
- [**YOLO Backbone Architecture : Feature Extractor and Region Proposals**](#yolo-backbone-architecture--feature-extractor-and-region-proposals)
- [**Customize PASCAL VOC Dataset**](#customize-pascal-voc-dataset)
- [**Process the Predicted Bounding Boxes from YOLO Model and Obtain Final Target Boxes**](#process-the-predicted-bounding-boxes-from-yolo-model-and-obtain-final-target-boxes)
    - [**Step 1 : Convert bounding boxes relative to cell ratio into entire image ratio**](#step-1--convert-bounding-boxes-relative-to-cell-ratio-into-entire-image-ratio)
    - [**Step 2 : Non-Maximal Suppression onto Predicted Bounding Boxes**](#step-2--non-maximal-suppression-onto-predicted-bounding-boxes)
- [**Calculate Mean Average Precison (mAP) between Predicted Boxes and Ground Truths**](#calculate-mean-average-precison-map-between-predicted-boxes-and-ground-truths)
- [**Computing Loss and Optimizing the Model**](#computing-loss-and-optimizing-the-model)
- [**Training Result & Display Predicted Anchors from Trained Model onto Image**](#training-result--display-predicted-anchors-from-trained-model-onto-image)

<br/>

## **Reference**

<br/>

- [**Path Aggregation Network for Instance Segmentation, Shu Liu, 2018**](https://arxiv.org/pdf/1803.01534v4.pdf){:target="_blank"}

<br>

## **Architecture of Path Aggregation Network (PANet)**

<br>

- Path Aggregation Network (PANet) is an improvement from Feature Pyramidal Network (FPN) that is used in Mask R-CNN for instance segmentation.

- With a few modifications to basic structure of FPN, PANet can enhance the entire feature hierarchy and present more comprehensive and useful feature maps for instance segmentation by integrating features across entire 

<br>

### **Bottom-Up Path Augmentation**

<br>


- While FPN introduced the concept of a top-down pathway that combines high-level semantic information with low-level spatial details, PANet further improves this by incorporating a bottom-up pathway. 

- In FPN, features are assigned to proposals according to the size of proposals. Low-level features with high resolution are assigned to small proposals and higher level features with lower resolution to large proposals. This kind of strategy is based on an insight that smaller objects are more sensitive to spatial resolution to maintain fine grained details, whereas larger objects are largely robust to smaller details and rather depend on richer semantic context captured from large receptive field.

- However, propagating low-level patterns that possess relatively accurate instance localization to higher level of the pyramid turns out to significantly enhance the performance of instance recognition. 

- Despite the presence of a path connecting low-level structures to the topmost features in FPN, the length of this path are excessively long, extending to over 100 layers. 